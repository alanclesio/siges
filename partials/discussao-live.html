<div class="page-title">
    <h2><i class="icon-desktop color"></i>Discussão
        <small>Visualização por tópico</small>
    </h2>
    <hr>
</div>
<div class="awidget clearfix">
    <div class="awidget-body">
        <h2>{{discussao.titulo}}</h2>

        <div class="recent-meta" ng-repeat="usuario in usuarios" ng-if="usuario.md5_hash == discussao.md5_hash">
            Postado por {{usuario.nome}} às {{discussao.dataHora | date:'dd\/MM\/yyyy \'às\' HH:mm' }}
        </div>
        <p>{{discussao.texto}}</p>
        <hr/>
        <ul class="chats" ng-repeat="resposta in discussao.respostas">
            <li ng-class="{'by-me': $odd, 'by-other': $even}">
                <div ng-class="{'pull-left':$odd, 'pull-right': $even}">
                    <img ng-src="http://www.gravatar.com/avatar/{{resposta.autor.md5_hash}}?s=100"
                         title="{{resposta.autor.nome}}" data-toggle="tooltip"
                         class="img-thumbnail img-circle img-responsive">
                </div>
                <div class="chat-content">
                    <div class="chat-meta">
                        <h3 style="margin-top: 0">{{resposta.titulo}}
                            <small class="pull-right">{{resposta.dataHora | date:'dd\/MM\/yyyy \'às\' HH:mm' }}
                                <button class="btn btn-default btn-xs"
                                        ng-if="resposta.autor.md5_hash == usuarioLogado.md5_hash"
                                        ng-click="removerResposta(resposta)">
                                    <i class="icon-remove"></i>
                                </button>
                            </small>
                        </h3>
                    </div>
                    {{resposta.texto}}
                    <div class="clearfix"></div>
                </div>
            </li>
            <hr/>
        </ul>
        <form name="respostaDiscussao">
            <div class="form-group" ng-class="{'has-error': respostaDiscussao.titulo.$invalid}">
                <label class="control-label">Título</label>
                <input type="text" name="titulo" class="form-control" placeholder="Título da resposta"
                       ng-minlength="3" ng-model="resposta.titulo" autofocus required>
                <span ng-show="respostaDiscussao.titulo.$error.required" class="help-block">Campo de preenchimento necessário</span>
                    <span ng-show="respostaDiscussao.titulo.$error.minlength"
                          class="help-block">Pelo menos três caracteres</span>
            </div>
            <div class="form-group" ng-class="{'has-error': respostaDiscussao.texto.$invalid}">
                <label class="control-label">Texto da discussao</label>
                <textarea name="texto" cols="30" rows="10" class="form-control" placeholder="Texto da resposta"
                          ng-minlength="10" ng-model="resposta.texto" required></textarea>
                <span ng-show="respostaDiscussao.texto.$error.required" class="help-block">Campo de preenchimento necessário</span>
                    <span ng-show="respostaDiscussao.texto.$error.minlength"
                          class="help-block">Pelo menos dez caracteres</span>
            </div>
            <div class="form-group pull-right">
                <button type="submit" class="btn btn-info" ng-click="responder()"
                        ng-disabled="respostaDiscussao.$invalid">Responder
                </button>
            </div>
        </form>
    </div>
</div>
